<form
  [formGroup]="dynamicForm"
  (ngSubmit)="submitEvent.emit(true)"
  class="p-3 flex flex-col"
>
  <ng-container
    *ngTemplateOutlet="
      renderControlRecursive;
      context: {
        control: dynamicForm,
        controlKey: 5
      }
    "
  ></ng-container>

  <ngx-button-component
    [disable]="dynamicForm.pristine || dynamicForm.invalid"
    roundedFull="rounded-md"
    >Submit
  </ngx-button-component>
</form>

<ng-template
  #renderControlRecursive
  let-control="control"
  let-controlKey="controlKey"
>
  <ng-container [ngSwitch]="control.constructor.name">
    <!-- Render FormArray -->
    {{ controlKey }}
    <ng-container *ngSwitchCase="'FormArray'">
      <ng-container
        *ngFor="
          let arrayControl of control.controls;
          trackBy: generateFormBuilderService.trackBy
        "
      >
        <ng-container
          *ngTemplateOutlet="
            renderControlRecursive;
            context: { control: arrayControl, controlKey: controlKey }
          "
        >
        </ng-container>
      </ng-container>
    </ng-container>

    <!-- Render FormGroup -->
    <ng-container *ngSwitchCase="'FormGroup'">
      <ng-container
        *ngFor="
          let groupControl of control.controls | keyvalue;
          trackBy: generateFormBuilderService.trackBy
        "
      >
        <ng-container
          *ngTemplateOutlet="
            renderControlRecursive;
            context: {
              control: groupControl.value,
              controlKey: groupControl.key
            }
          "
        ></ng-container>
      </ng-container>
    </ng-container>

    <!--    &lt;!&ndash; Render FormControl &ndash;&gt;-->
    <!--    <ng-container *ngSwitchDefault>-->
    <!--      <ngx-form-control-label-->
    <!--        [formControl]="control"-->
    <!--        [labelInput]="controlMapping[controlKey]?.labelHint"-->
    <!--        [label]="controlKey"-->
    <!--        [placeholderInput]="controlMapping[controlKey]?.placeholder"-->
    <!--        [toggleData]="controlMapping[controlKey]?.valueToggleShow"-->
    <!--        [typeInput]="controlMapping[controlKey]?.typeInput"-->
    <!--      ></ngx-form-control-label>-->
    <!--    </ng-container>-->
  </ng-container>
</ng-template>
